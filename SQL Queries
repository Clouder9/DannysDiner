-- 1. What is the total amount each customer spent at the restaurant?
SELECT sales.customer_id,
       SUM(menu.price) AS Total_Spend
  FROM sales
       JOIN
       menu ON sales.product_id = menu.product_id
 GROUP BY sales.customer_id;

-- 2. How many days has each customer visited the restaurant?
SELECT customer_id,
       COUNT( * ) AS Visits
  FROM sales
 GROUP BY customer_id;

-- 3. What was the first item from the menu purchased by each customer?
SELECT DISTINCT s.customer_id,
                menu.product_name
  FROM sales s
       JOIN
       menu ON s.product_id = menu.product_id
 WHERE s.order_date = (
                          SELECT MIN(order_date) 
                            FROM sales
                           WHERE customer_id = s.customer_id
                      );

-- 4. What is the most purchased item on the menu and how many times was it purchased by all customers?
SELECT menu.product_name,
       COUNT(menu.product_name) 
  FROM sales
       JOIN
       menu ON sales.product_id = menu.product_id
 GROUP BY menu.product_name
 ORDER BY COUNT(menu.product_name) DESC
 LIMIT 1;
